---
title: 19-11 OIDC
description: 19-11 OIDC
permalink: 19-11_OIDC.html
sidebar: oidc
---


 Siste release før jul etablerer Maskinporten som ei sjølvstendig teneste, og samstundes lanserer me i samarbeid med Altinn ein pilot der kunder kan delegering tildelte API-tilganger vidare til underleverandørar.    For OIDC-provider inneheld releasen primært ein del ytelsesforbetringar.  
Releasen vart produksjonssatt 2019-12-10

## Ny funksjonalitet:


#### PoC: Ekstern delegering

 Funksjonalitet som lar API-konsumenter delegere sin tildelte API-tilgang videre til en systemleverandør.&nbsp; Gyldig delegering må foreligge for at ID-porten skal kunne utstede tokens. Selve delegeringshandlingen skjer ved at bemyndiget person for virksomheten logger inn i Altinn og utfører delegering.  I 2019 realiseres en pilot av funksjonaliten. 


#### Maskinporten som eigen teneste

 Maskinporten skal etableres på eigne applikasjonsservere, for å frikoble avhengigheiter til person-innloggingane i OIDC-provider.    Tiltaket medfører at Maskinporten får eigne metadata, og kundar må sikre at dei konfigurer integrasjonane sine mot riktig "port". 

## Forbetringar:

#### ikkje tillate # i redirect uri (PBLEID-18884)

Oppdaga at ein kunde hadde fått registrert ein redirect_uri med fragment (hash-teikn, #) i.  Dette er ikkje lov ihht oauth-spec:

https://tools.ietf.org/html/rfc6749#section-3.1.2 seier
  The redirection endpoint URI MUST be an absolute URI as defined by  [RFC3986] Section 4.3.  The endpoint URI MAY include an    "application/x-www-form-urlencoded" formatted (per Appendix B) query   component ([RFC3986] Section 3.4), which MUST be retained when adding   additional query parameters.  The endpoint URI MUST NOT include a fragment component.

opppdatere sp-backend, sp-api, admin og sp-web til å validere på at # ikkje skal kunne registrerast.

Må lage to nye saker på idporten-admin og sp-web.



#### publisere lista over prefixer som åpne data (PBLEID-18840)

Lage eit åpent endpunkt /prefix/all  som lister ut alle prefixer for alle organisasjoner.

## Feilrettingar:

#### auth_time i ID-token skal settes lik AuthnInstant fra SAML assertion (PBLEID-18981)

auth_time i ID-token settes i dag lik tid create på authorization-instansen.

Dette blir feil dersom innlogginga er basert på ein SSO-sesjon frå openAM

auth_time bør settes lik "AuthnInstant" i AuthnStatement fra SAML2 assertion

Sjå i koden her: no.idporten.oidc.provider.service.TokenService#buildIdToken

#### swagger på clientrequestresource lister ulovelege claims (PBLEID-18861)

OIDCClientExternalRequestResource har nokre claims som ikkje er tillatt:
 - client_orgno
 - active

active burde vore vekke frå request-modell, og i respons-modell burde det stå at active blir generert av systemet (slik det står på client_secret)